name: Scrape
on:
  schedule:
    - cron: "*/15 * * * *"
  workflow_dispatch:
jobs:
  scrape:
    name: "Scrape latest photo"
    runs-on: ubuntu-latest
    steps:
      - name: "(setup) checkout"
        uses: actions/checkout@v2

      - name: "(setup) deno"
        uses: denoland/setup-deno@v1
        with:
          deno-version: v1.x

      - name: "(setup) assets directory"
        run: >-
          if [ ! -d "./assets" ]; then
            mkdir -p -v ./assets && \
            printf "\n\e[1;32mðŸš¼ Successfully created %s\e[0m\n\n" "./assets"
          fi
        working-directory: ./

      - name: deno run
        run: deno run --unstable --allow-net --allow-read --allow-write main.ts

      - name: commit + push
        uses: actions-js/push@master
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          coauthor_name: "Nicholas Berlette"
          coauthor_email: "nick@berlette.com"
          message: "chore(automated): add photo"
          directory: "./assets"
